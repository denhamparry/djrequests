# Adopt Rhiwbina Squirrels #1415 design system

## Context
- Issue: https://github.com/denhamparry/djrequests/issues/5
- Rhiwbina Squirrels #1415 is the source of truth for typography, color, spacing, and component styling.
- The current UI is a single page rendered by `src/App.tsx` with all styling in `src/styles.css`. No component library or token layer exists yet.
- Automated coverage lives in `src/__tests__/SearchView.test.tsx` and asserts against visible copy and button labels, so wording shifts must be intentional.

## Goals
- Replace global styles with a token-driven system that mirrors the reference typography, color palette, spacing, elevations, and radii.
- Align the search hero, request form entry field, results list cards, and confirmation feedback with the supplied mockups at desktop, tablet, and mobile breakpoints.
- Preserve (or improve) accessibility with focus outlines, color contrast, and screen reader cues after the redesign.

## Non-goals
- Changing the search/request data flow (hooks, Netlify functions, Google Form wiring) unless styling requires minor prop adjustments.
- Shipping new UX flows (e.g., new modals, onboarding) beyond what exists in the reference design.

## Research findings
- Fonts are currently loaded via system stacks only; expect to add at least one custom family from the design system.
- Layout is constrained to a centered `main.app` wrapper (max-width 640px) with grid-based results cards; responsive logic is minimal.
- There is no design token or theme file; introducing CSS variables (or another token approach) will require updating `main.tsx` imports and restructuring the stylesheet.
- Playwright is configured but unused for visual checks. We should rely on unit tests plus manual review unless a visual baseline is introduced.

## Plan

### 1. Source and formalize design tokens
- Export color, typography, spacing, radius, and shadow values from the Rhiwbina Squirrels #1415 files (Figma, JSON, or provided documentation).
- Decide the delivery format (recommended: CSS custom properties) and create `src/styles/design-tokens.css`, grouped by foundations (colors, typography, motion).
- Document token naming conventions and map any existing values that can be reused to reduce churn.

### 2. Set up typography and asset loading
- Add `@font-face` declarations or self-hosted font files if the design system requires non-system fonts; ensure licensing allows bundling.
- Update `src/styles.css` (or new global stylesheet) to establish the base font stack, body/background color, and root scale using the new tokens.
- Verify fallback fonts and font-smoothing rules to avoid layout shift between dev and production builds.

### 3. Restructure UI components for the design system
- Break `src/App.tsx` into presentational components (e.g., `SearchHero`, `SearchField`, `ResultsList`, `RequestButton`) under a new `src/components/` directory to mirror design sections and simplify styling.
- Ensure stateful logic (search hook, request submission) stays in `App` or dedicated container components while presentational pieces focus on rendering.
- Update props and tests to accommodate the new component boundaries without altering behavior.

### 4. Apply visual styles and responsive rules
- Replace existing class names and styles with design-system-driven classes that consume the new tokens.
- Implement responsive breakpoints, spacing, and layout patterns defined in the reference (e.g., card grid columns, hero copy alignment, footer spacing).
- Add design-specific UI details such as iconography, dividers, or surface elevations where called for.

### 5. Interaction, accessibility, and state polish
- Define focus-visible treatments, hover/active states, and disabled styles per the design tokens.
- Audit ARIA roles, live regions, and announcements (`status`, `alert`) to confirm they remain accurate once markup changes.
- Revisit empty state, loading state, and error messaging layouts to ensure they remain legible and on-brand.

### 6. Validation and regression checks
- Run `npm run lint`, `npm run test:unit`, and (if updated) `npm run test:e2e` to detect regressions caused by markup or copy changes.
- Capture before/after screenshots at key breakpoints (mobile 375px, tablet 768px, desktop 1280px) for stakeholder review.
- Prepare a checklist of changes (tokens introduced, components touched, tests updated) and note any deviations from the design system for follow-up.

### 7. Review and handoff
- Share the updated UI, token documentation, and screenshots with stakeholders for approval.
- Record onboarding notes in `docs/progress.md` or `docs/plan.md` about the new design system integration for future contributors.
- Create follow-up issues for any remaining screens or components not covered by this pass.

## Risks and mitigations
- **Incomplete design assets**: If the token export is missing values, schedule a working session with designers and log assumptions in the PR.
- **Global stylesheet churn**: Stage changes in layers (tokens → layout shell → components) and lean on component extraction to isolate diffs.
- **Accessibility regressions**: Use tooling like the Chrome Accessibility tree or axe DevTools while iterating; confirm contrast ratios once colors are applied.
- **Test brittleness**: Update snapshots and user-facing copy assertions alongside markup changes to keep the Vitest suite green.

## Dependencies
- Access to the latest Rhiwbina Squirrels #1415 style guide, token exports, and asset files (fonts, icons, illustrations).
- Time from design stakeholders to review token naming and UI screenshots.
- Potential hosting for custom font files if the license disallows bundling in the repo.

## Acceptance criteria
- Global tokens (colors, typography, spacing, radii, shadows) are defined and consumed across the updated UI.
- The search hero, input field, results list, request button, and feedback states visually match the reference design at the supported breakpoints.
- Unit tests pass and reflect any intentional copy changes; linting is clean.
- Accessibility checks confirm WCAG AA contrast and focus visibility; interactive states respond per the design spec.
- Stakeholders have reviewed screenshots/documentation and signed off on the implementation.
